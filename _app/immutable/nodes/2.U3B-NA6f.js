import{a as g,f as k,t as G}from"../chunks/ECySUMoW.js";import{o as H}from"../chunks/CM_l0m0N.js";import{n as K,w as M,x as a,y as O,A as i,z as r,C as o,B as l,o as p,D as Q}from"../chunks/jF5NDd6F.js";import{e as V,s as X}from"../chunks/C42QnBG7.js";import{i as T,s as Z,a as ee}from"../chunks/BNuAvdpa.js";import{r as U,s as ae}from"../chunks/CtkpFaHU.js";import{b as $}from"../chunks/B5ipcxoC.js";import{g as B,b as L}from"../chunks/Dbl_ZpYO.js";import{J as se}from"../chunks/Ca1rf_Mj.js";import{s as R}from"../chunks/6KTD5yxm.js";function te(u){return function(...t){var c=t[0];return c.preventDefault(),u?.apply(this,t)}}function re(){if(typeof localStorage<"u"){const t=localStorage.getItem("deviceId");if(t)return t}const u="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var c=Math.random()*16|0,x=t=="x"?c:c&3|8;return x.toString(16)});return typeof localStorage<"u"&&localStorage.setItem("deviceId",u),u}var oe=k('<div class="error-message fade-in svelte-1uha8ag" role="alert"> </div>'),le=k('<span class="spinner svelte-1uha8ag" aria-hidden="true"></span> Connecting...',1),ie=k('<div class="page-container svelte-1uha8ag"><div class="login-card glass svelte-1uha8ag"><div class="logo svelte-1uha8ag"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" class="logo-icon svelte-1uha8ag" aria-label="JellySlides Logo"><path d="M11.968 0C5.394 0 0 5.418 0 12c0 6.643 5.394 12 11.968 12 6.634 0 12.032-5.418 12.032-12 0-6.643-5.385-12-12.032-12zm6.205 17.584c-1.393.743-3.612 1.34-6.197 1.34-4.524 0-7.796-2.454-7.796-6.866 0-4.603 3.498-7.567 8.163-7.567 2.454 0 4.603.488 5.79.996l-.99 2.56c-1.077-.384-2.735-.743-4.543-.743-2.903 0-4.9.932-4.9 4.384 0 3.018 2.053 4.195 4.883 4.195 1.597 0 3.033-.306 4.093-.725l1.492 2.426z"></path></svg> <h1 class="svelte-1uha8ag">JellySlides</h1> <p class="svelte-1uha8ag">Your media, beautifully displayed.</p></div> <div class="config-sections svelte-1uha8ag"><form class="login-form svelte-1uha8ag"><div class="form-group"><label for="url" class="form-label">Server Address</label> <input type="text" id="url" class="form-input" placeholder="e.g. 192.168.1.100:8096" required autocomplete="url"/></div> <div class="form-group"><label for="username" class="form-label">Username</label> <input type="text" id="username" class="form-input" placeholder="Username" required autocomplete="username"/></div> <div class="form-group"><label for="password" class="form-label">Password</label> <input type="password" id="password" class="form-input" placeholder="Password" required autocomplete="current-password"/></div> <!> <button type="submit" class="btn btn-primary login-btn svelte-1uha8ag"><!></button></form></div></div></div>');function be(u,t){K(t,!0);const c=()=>ee(R,"$serverConfig",x),[x,W]=Z();let f=p(""),d=p(""),h=p(""),v=p(!1),n=p("");H(()=>{c()&&B(`${L}/slideshow`)});async function N(){if(!a(f)||!a(d)){l(n,"Please fill in all fields");return}l(v,!0),l(n,"");try{let e=a(f).trim();e.startsWith("http")||(e="http://"+e),e.endsWith("/")&&(e=e.slice(0,-1));const s=re(),I={baseUrl:e,username:a(d),userId:"",accessToken:"",deviceId:s},S=await new se(I).authenticateUser(a(d),a(h));R.set({baseUrl:e,username:S.User.Name,userId:S.User.Id,accessToken:S.AccessToken,deviceId:s}),B(`${L}/config`)}catch(e){console.error(e),l(n,"Connection failed. Please check your URL and credentials."),e.message&&l(n,a(n)+` (${e.message})`)}finally{l(v,!1)}}var b=ie(),A=r(b),D=i(r(A),2),_=r(D),y=r(_),J=i(r(y),2);U(J),o(y);var w=i(y,2),P=i(r(w),2);U(P),o(w);var C=i(w,2),q=i(r(C),2);U(q),o(C);var z=i(C,2);{var Y=e=>{var s=oe(),I=r(s,!0);o(s),M(()=>X(I,a(n))),g(e,s)};T(z,e=>{a(n)&&e(Y)})}var m=i(z,2),j=r(m);{var E=e=>{var s=le();Q(),g(e,s)},F=e=>{var s=G("Connect");g(e,s)};T(j,e=>{a(v)?e(E):e(F,!1)})}o(m),o(_),o(D),o(A),o(b),M(()=>{m.disabled=a(v),ae(m,"aria-busy",a(v))}),$(J,()=>a(f),e=>l(f,e)),$(P,()=>a(d),e=>l(d,e)),$(q,()=>a(h),e=>l(h,e)),V("submit",_,te(N)),g(u,b),O(),W()}export{be as component};
